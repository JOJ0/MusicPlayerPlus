#!/bin/bash

MTITLE="MusicPlayerPlus Fuzzy Finder"
MPCOMM="fzmp -a"
SCRIPTS="/usr/share/musicplayerplus/scripts"

have_fzmp=`type -p fzmp`
[ "${have_fzmp}" ] || exit 1

have_gnome=`type -p gnome-terminal`
have_kitty=`type -p kitty`
have_tilix=`type -p tilix`

if [ "${DISPLAY}" ]
then
  status=0
  if [ -x ${SCRIPTS}/check_tty.sh ]
  then
    ${SCRIPTS}/check_tty.sh
    status=$?
  else
    have_tty=`type -p tty`
    [ "${have_tty}" ] && {
      tty=$(tty)
      echo "${tty}" | grep /dev/tty > /dev/null && status=1
      echo "${tty}" | grep /dev/con > /dev/null && status=1
    }
  fi
  [ ${status} -eq 0 ] || {
    have_gnome=
    have_kitty=
    have_tilix=
  }
else
  have_gnome=
  have_kitty=
  have_tilix=
fi

if [ "${have_kitty}" ]
then
  kitty --title="${MTITLE}" ${MPCOMM} 2> /dev/null
else
  if [ "${have_tilix}" ]
  then
    tilix --title="${MTITLE}" \
          --window-style=borderless \
          --geometry=90x20+150+25 \
          --profile=MusicPlayer \
          --command="${MPCOMM}" 2> /dev/null
  else
    if [ "${have_gnome}" ]
    then
      gnome-terminal --title="${MTITLE}" \
          --profile=MusicPlayer \
          --hide-menubar \
          --geometry=90x20+150+25 \
          -- ${MPCOMM}
    else
      ${MPCOMM}
    fi
  fi
fi
